<html>
	<head>
		<meta charset="UTF-8">
			<script src="/socket.io/socket.io.js"></script>
			<script src="../../dependencies/jquery/jquery.js"></script>
			<script src="jsmpeg-master/jsmpeg.min.js"> </script>
			
			<script type="text/javascript" src="js/ui.js"></script>
			<link type="text/css" href="css/main.css" rel="stylesheet" />
			<script type="text/javascript" src="../../dependencies/jquery/jquery.js"></script>
			<script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jqueryui/1.8.13/jquery-ui.min.js"></script>
			<!-- <script src="jsmpeg-master/websocket-relay.js"></script> -->
		
<script>
var socket = io(); 

function load(){
			var query = window.location.search.substring(1);
			query = parse_query_string(query);
			var buf = [];
			
		    var player = new JSMpeg.Player(null,
				{
					videoBufferSize: 1024*1024 * 10,
					audioBufferSize: 256*1024 * 10,
					disableWebAssembly:false,
					source: JSMpegWritableSource,
					canvas:document.getElementById('myCanvas'),
					loop: true, 
					autoplay: true, 
					debug: true,
					onVideoDecode:function(what,time){
						//console.log("Videodecode",what,time)
					}
				});
				
			
			socket.emit("player", JSON.stringify({
                "file":query.file
			})); 
			
			socket.on('binarydata', function (data) {
				// pretend you are getting data as follows
				
					player.source.write(data,function(){});
					
			});
        <!-- var query = window.location.search.substring(1); -->
        <!-- query = parse_query_string(query); -->
		<!-- console.log("pleayer query:",query) -->
		<!-- socket.emit("player", JSON.stringify({ -->
                <!-- "file":query.file -->
			<!-- }));  -->
		<!-- var player = new JSMpeg.Player(url [, options]); -->
}

async function write(bufferarray,player){
	for (let i=0;i<bufferarray.length;i++){
		player.source.write(bufferarray[i]);
	}
}
<!-- <!-- function attachVideoControls(){ --> -->
	<!-- <!-- var vid = document.getElementById("video"); --> -->
	<!-- <!-- vid.ontimeupdate = function(){ --> -->
	  <!-- <!-- var percentage = ( vid.currentTime / vid.duration ) * 100; --> -->
	  <!-- <!-- console.log("time update",vid.currentTime) --> -->
	  <!-- <!-- $("#custom-seekbar span").css("width", percentage+"%"); --> -->
	<!-- <!-- }; --> -->

	<!-- <!-- $("#custom-seekbar").on("click", function(e){ --> -->
		<!-- <!-- var offset = $(this).offset(); --> -->
		<!-- <!-- var left = (e.pageX - offset.left); --> -->
		<!-- <!-- var totalWidth = $("#custom-seekbar").width(); --> -->
		<!-- <!-- var percentage = ( left / totalWidth ); --> -->
		<!-- <!-- var vidTime = vid.duration * percentage; --> -->
		<!-- <!-- vid.currentTime = vidTime; --> -->
	<!-- <!-- });//click() --> -->

<!-- <!-- } --> -->
		
function parse_query_string(query) {
	var vars = query.split("&");
	var query_string = {};
		for (var i = 0; i < vars.length; i++) { var pair=vars[i].split("=" ); var key=decodeURIComponent(pair[0]); var value=decodeURIComponent(pair[1]); 
		//If first entry with this name
		if (typeof query_string[key]==="undefined" ) { 
		query_string[key]=decodeURIComponent(value); 
		//If second entry with this name 
		} else if (typeof query_string[key]==="string" ) { var arr=[query_string[key], decodeURIComponent(value)]; query_string[key]=arr; 
		//If third or later entry with this name
		} else { query_string[key].push(decodeURIComponent(value)); } } 
	
	return query_string;
	
}

</script>
</head>

<body onload="load()">

<div id="controlContainer" class="ui-widget">
		<!-- <video id="video" src="http://localhost:1935/live" controls> -->
			<!-- </video> -->
			<canvas id="myCanvas" width="512" height="240"></canvas><br/>
			<div id="controlTable" class="ui-widget-content">
					<ul id="controlButtons">
						
						<li id="buttonPlay" class="button48  ui-corner-all paused" title="Play"></li>
						
						<li id="buttonStop" class="button48  ui-corner-all" title="Stop"></li>
						<li id="buttonFull" class="button48  ui-corner-all" title="Full Screen"></li>
					</ul>
					<div id="seekContainer">
					<div id="seekSlider" title=""></div>
					<div id="currentTime" class="dynamic">00:00:00</div>
					<div id="totalTime" class="dynamic">00:00:00</div>
				</div>
			</div>
</div>
			<!-- <div id="custom-seekbar"> -->
				<!-- <span/> -->
			<!-- </div> -->
</body>
</html>