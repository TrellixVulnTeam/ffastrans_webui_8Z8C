<html>
<head>
<script src="/socket.io/socket.io.js"></script>
 <script src="../dependencies/dhtmlx/dhtmlx.js"></script> 
 <link rel="stylesheet" href="../dependencies/dhtmlx/dhtmlx.css" type="text/css"> 


<!-- <script src="../dependencies/dhtmlx/vault/vault.js"></script> -->
<!-- <link rel="stylesheet" href="../dependencies/dhtmlx/vault/vault.css" type="text/css"> -->
<script src="../dependencies/jquery/jquery.js"></script>
<link rel="icon" href="favicon.ico?v=1.1">
<link rel="stylesheet" href="../dependencies/fontawesome/css/all.css" />


<!-- <link href="../dependencies/fancytree/modules/jquery.resizableColumns.css" rel="stylesheet"> -->
<!-- <script src="../dependencies/fancytree/modules/jquery.resizableColumns.js"></script> -->

<script src="../dependencies/fancytree/modules/colResizable-1.6.min.js"></script>
<link href="../dependencies/fancytree/skin-custom-1/ui.fancytree.css" rel="stylesheet">
<script src="../dependencies/fancytree/modules/jquery.fancytree.ui-deps.js"></script>
<script src="../dependencies/fancytree/modules/jquery.fancytree.js" type="text/javascript"></script>
<script src="../dependencies/fancytree/modules/jquery.fancytree.dnd.js" type="text/javascript"></script>
<script src="../dependencies/fancytree/modules/jquery.fancytree.filter.js" type="text/javascript"></script>
<script src="../dependencies/fancytree/modules/jquery.fancytree.edit.js" type="text/javascript"></script>
<script src="../dependencies/fancytree/modules/jquery.fancytree.gridnav.js" type="text/javascript"></script>
<script src="../dependencies/fancytree/modules/jquery.fancytree.table.js" type="text/javascript"></script>
<script src="../dependencies/fancytree/modules/jquery.fancytree.multi.js"></script>
<script src="../dependencies/fancytree/modules/jquery.fancytree.fixed.js"></script>
<script src="../dependencies/fancytree/modules/jquery.fancytree.contextmenu.js"></script>


<!-- jquery-contextmenu (https://github.com/swisnl/jQuery-contextMenu) -->
<link rel="stylesheet"
      href="../dependencies/fancytree/modules/jQuery-contextMenue/jquery.contextMenu.min.css" />
<script src="../dependencies/fancytree/modules/jQuery-contextMenue/jquery.contextMenu.min.js">
</script>

<style>
    /* it's important to set width/height to 100% for full-screen init */
    html, body {
        /* width: 100%; */
        height: 100%;
        margin: 0px;
        overflow: hidden;
        color: #333;
        font: 14px Helvetica, Arial, sans-serif;
        line-height: 18px;
    }
    .sidenav {
      height: 100%;
      float:left;
      z-index: 1;
      top: 0;
      left: 0;
      overflow-x: hidden;
      padding-top: 20px;
      border-right: 1px solid #AAA;
    }
    .sidenav a {
      padding: 6px 8px 6px 16px;
      text-decoration: none;
      font-size: 12px;
      color: #000000;
      display: block;
    }
    .button {
        display: block;
        height: 15px;
        width:100%;
        margin-top:2px;
        text-align: center;
        cu:pointer;
        background-color: #DDD;
        border: 1px solid #AAA;
        display: block;
    }
    .farm_iframe{
        height:100%;
        width:100%;
    }
</style>

<script>
    /* init SOCKET.IO */
    var socket = io();

    /* GLOBALS */
    var mainLayout, runningJobGrid, finishedJobGrid, m_serverconfig, m_userpermissions, m_lastsortelementid, m_lastsortdir;
    var m_rowColorError = "#f28d80"
    var m_rowColorCancelled = "#ffcc80"

    /*load config from server*/
    function loadserverconfig() {
        $.ajax({
            url: ("/getuserpermissions" + "?" + Math.random()),
            type: "GET",
            success: function(response) {
                
                m_userpermissions = JSON.parse(response);
                //load serverconfig and initialize page
                $.ajax({
                    url: ("/getserverconfig" + "?" + Math.random()),
                    type: "GET",
                    success: function(response) {
                        m_serverconfig = JSON.parse(response);
                        init();
                    },
                    error: function(xhr, status) {
                        dhtmlx.message("Fatal error, could not load serverconfig. ");
                        document.body.innerHTML = "Fatal error, could not load serverconfig. " + xhr.responseText;
                    }
                });
            },
            error: function(xhr, status) {
                dhtmlx.message("Fatal error, could not load serverconfig. ");
                document.body.innerHTML = "Fatal error, could not load serverconfig. " + xhr.responseText;
            }

        });

    }

        
    /* build basic page layout and init periodic job loading*/
    function init() {
        var contentiframe = document.getElementById("farm_iframe");
        //restore last session
        contentiframe.src = document.getElementById(localStorage.getItem("selected_farm_menu_item")).dataset["url"];
       //button click
        $('.button').click(function(e){
           localStorage.setItem("selected_farm_menu_item",this.id);
           if (this.id=="machines"){
                console.log(contentiframe)
                contentiframe.src = document.getElementById(this.id).dataset["url"];
           }
           if (this.id=="metrics"){
           
           }
        });

        //prometheus.attachURL("farmadmin/farm_machines.html", false);

    }
    


</script>
<body onload="loadserverconfig()">
<div class="sidenav ">
  <div id="machines" class="button dhtmlxMenu_dhx_skyblue_TopLevel_Item_Normal" data-url="farmadmin/farm_machines.html">Farm Machines</div><br/>
  <div id="metrics" class="button dhtmlxMenu_dhx_skyblue_TopLevel_Item_Normal" data-url="">Metrics</div>
</div>


<div class="main" >
<iframe class="farm_iframe" style="width:90%" id="farm_iframe"/>
</div>
</body>
